<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Visualizing SDF in Blender | Ivan 🇺🇦 Puhachov </title> <meta name="author" content="Ivan 🇺🇦 Puhachov"> <meta name="description" content="Colorcoding distance to the object with Blender Geometry Nodes"> <meta name="keywords" content="geometry, graphics, phd, montreal, computer graphics"> <meta property="og:site_name" content="Ivan 🇺🇦 Puhachov"> <meta property="og:type" content="website"> <meta property="og:title" content="Ivan 🇺🇦 Puhachov | Visualizing SDF in Blender"> <meta property="og:url" content="https://puhachov.xyz/projects/Visualizing-SDF-in-Blender/"> <meta property="og:description" content="Colorcoding distance to the object with Blender Geometry Nodes"> <meta property="og:image" content="/assets/img/prof_pic.jpg"> <meta property="og:locale" content="en"> <meta name="twitter:card" content="summary"> <meta name="twitter:title" content="Visualizing SDF in Blender"> <meta name="twitter:description" content="Colorcoding distance to the object with Blender Geometry Nodes"> <meta name="twitter:image" content="/assets/img/prof_pic.jpg"> <meta name="twitter:site" content="@ivanpuhachov"> <meta name="twitter:creator" content="@ivanpuhachov"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8D%BF&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://puhachov.xyz/projects/Visualizing-SDF-in-Blender/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?bf50d6d9dd867d3e0f3b0add94449649"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Visualizing SDF in Blender",
            "description": "Colorcoding distance to the object with Blender Geometry Nodes",
            "published": "January 27, 2024",
            "authors": [
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Ivan </span> 🇺🇦  Puhachov </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">research </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Visualizing SDF in Blender</h1> <p>Colorcoding distance to the object with Blender Geometry Nodes</p> </d-title> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div> <a href="#setting-up-a-scene">Setting up a scene</a> </div> <div> <a href="#setting-up-color-attribute">Setting up color attribute</a> </div> <div> <a href="#geometry-node">Geometry node</a> </div> <div> <a href="#signed-distance-value">“Signed” distance value</a> </div> <div> <a href="#animation-with-keyframes">Animation with keyframes</a> </div> </nav> </d-contents> <p>TLDR: jump to <a href="#geometry-node">Geometry Node</a></p> <p>Visualizing SDF in Blender. Normally, one would use KBD-tree to process input mesh and compute SDF value for any query point. We don’t want that, we want something interactive, simple, and in directly Blender - come and meet the Geometry Nodes!</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <img class="img-fluid rounded z-depth-1" src="/assets/img/sdf_torus/0030.png" data-zoomable=""> </div> </div> <div class="caption"> Example visualization with Torus and Plane. Scroll down for animation! </div> <p>We will use Vertex Color Attribute to store color properties for each vertex in the cross-section plane. And Color Attribute is computed on-the-go with Geometry Nodes.</p> <h2 id="setting-up-a-scene">Setting up a scene</h2> <p>We want to view SDF values for <code class="language-plaintext highlighter-rouge">Torus</code> on <code class="language-plaintext highlighter-rouge">Plane</code> cross-section. You can use any “cross-section” surface really, as long as it has enough vertices so it looks nice (mesh colors will be interpolated by per-vertex color attribute). For default <code class="language-plaintext highlighter-rouge">Plane</code> object in Blender you need to subdivide it: <code class="language-plaintext highlighter-rouge">Tab</code>  to get to edit mode, then <code class="language-plaintext highlighter-rouge">F3</code>  to search and use <code class="language-plaintext highlighter-rouge">mesh.subdivide</code>  operation.</p> <div class="l-gutter"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/sdf_torus/image-480.webp 480w,/assets/img/sdf_torus/image-800.webp 800w,/assets/img/sdf_torus/image-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/sdf_torus/image.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h2 id="setting-up-color-attribute">Setting up color attribute </h2> <p>In <code class="language-plaintext highlighter-rouge">Object Data</code> menu create new <code class="language-plaintext highlighter-rouge">Color Attribute</code> (I name it <code class="language-plaintext highlighter-rouge">new_color_attribute</code> here). Then make sure your Material BSDF takes this color attribute as mesh vertex color</p> <div class="l-gutter"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/sdf_torus/image2-480.webp 480w,/assets/img/sdf_torus/image2-800.webp 800w,/assets/img/sdf_torus/image2-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/sdf_torus/image2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <img class="img-fluid rounded z-depth-1" src="/assets/img/sdf_torus/image3.png" data-zoomable=""> </div> </div> <h2 id="geometry-node">Geometry node</h2> <p>Now we fill values of the color attribute using Geometry Node. In <code class="language-plaintext highlighter-rouge">Modifiers</code> menu create a new Geometry Node and fill it with these nodes:</p> <div class="l-page"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/sdf_torus/image4-480.webp 480w,/assets/img/sdf_torus/image4-800.webp 800w,/assets/img/sdf_torus/image4-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/sdf_torus/image4.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>Geometry Node design is pretty self-explanatory: for each vertex <code class="language-plaintext highlighter-rouge">Position</code>  we compute distance with <code class="language-plaintext highlighter-rouge">Geometry Proximity</code> node, then map this distance value to <code class="language-plaintext highlighter-rouge">Color Ramp</code> with <code class="language-plaintext highlighter-rouge">Map Range</code>, and write the color to <code class="language-plaintext highlighter-rouge">new_color_attribute</code>.<br> Don’t forget to fill the <code class="language-plaintext highlighter-rouge">Object</code> input field in Modifier info as shown here:</p> <div class="l-gutter"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/sdf_torus/image5-480.webp 480w,/assets/img/sdf_torus/image5-800.webp 800w,/assets/img/sdf_torus/image5-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/sdf_torus/image5.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>We now have something like this:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <img class="img-fluid rounded z-depth-1" src="/assets/img/sdf_torus/sdf1.png"> </div> </div> <h2 id="signed-distance-value">“Signed” distance value</h2> <p>Well, we don’t have “signed” values, do we? I haven’t found a way to fix this with Geometry Nodes, but we can do it much simpler: just copy the node and create the same one for the “inside” portion of visualization (negative values) and change the colors.</p> <div class="l-page"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/sdf_torus/image6-480.webp 480w,/assets/img/sdf_torus/image6-800.webp 800w,/assets/img/sdf_torus/image6-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/sdf_torus/image6.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>We then use boolean operations to get the “inner” and “outer” part. Duplicate existing plane and use <code class="language-plaintext highlighter-rouge">Intersect</code> boolean modifier <code class="language-plaintext highlighter-rouge">Intersect</code>. Do the same for the first plane, but taking the <code class="language-plaintext highlighter-rouge">Difference</code> instead. </p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure class="mx-auto" style="max-width: 300px;"> <img class="img-fluid rounded z-depth-1" src="/assets/img/sdf_torus/image7.png" data-zoomable=""> </figure> </div> </div> <p>Tip: select both planes and hit <code class="language-plaintext highlighter-rouge">Ctrl + P</code>  to build a hierarchy which preserves transformations (<code class="language-plaintext highlighter-rouge">Keep Transform</code>). This will help with animating the plane later.</p> <div class="l-gutter"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/sdf_torus/image8-480.webp 480w,/assets/img/sdf_torus/image8-800.webp 800w,/assets/img/sdf_torus/image8-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/sdf_torus/image8.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>Now you get something like the top figure. You can play with color ramp, lights and shade to make it better. Blender Freestyle overlay may help with volume, and Toon Shader is nice to flatten out the shape.</p> <div class="l-gutter"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/sdf_torus/sdf2-480.webp 480w,/assets/img/sdf_torus/sdf2-800.webp 800w,/assets/img/sdf_torus/sdf2-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/sdf_torus/sdf2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h2 id="animation-with-keyframes">Animation with keyframes</h2> <p>We can put keyframes on plane position and animate its movement. Once rendered, compose a video file from png images with:</p> <p><code class="language-plaintext highlighter-rouge">ffmpeg -framerate 12 -i anim_sdf/%4d.png -c:v libx264 output.mp4</code></p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/img/sdf_torus/sdf.mp4" class="img-fluid rounded z-depth-2" width="auto" height="auto" controls=""></video> </figure> </div> </div> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2024 Ivan 🇺🇦 Puhachov. Powered by <a href="http://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. </div> </footer> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>